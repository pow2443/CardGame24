package cardGame24;

import java.awt.Toolkit;
import java.awt.event.*;
import java.io.*;
import java.util.*;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import javax.swing.*;
import javax.swing.Timer;

/**
 * Class:       <b>CardDriver</b>
 * File:        CardDriver.java
 * <pre>
 * Description: This class uses DeckOfCards, GenericStack, and PrintUtilities 
 *               classes to call their methods. DeckOfCards simply creates card
 *               ,put them in ArrayList and randomly generate cards. GenericStack
 *               class is used in evaluateExpression() method and 
 *               ProcessAnOperator() method to push and pop the stack if user 
 *               types the expression in the right order; otherwise it throws
 *               error message. javax.swing.Timer class is used to start the 
 *               timer of 60 seconds, when it reaches 0, it ends the game. This 
 *               class also calls StackException class which inherits 
 *               EmptyStackException class and FullStackException class to read 
 *               user inputs and process it to the Stacks. 
 *               
 * Platform:     PC, Windows 7, jdk 1.8.0_25, NetBeans 8.0
 * Due Date:     3/12/2015
 * History Log:  3/6/2015, 3/7/2015, 3/9/2015, 3/10/2015, 3/11/2015, 3/12/2015
 * @version:    6.1
 * @see:        javax.swing.JFrame
 * @author:     <i>Fnu Michael, Mikey Dohyun Lim</i>
 * </pre>
 */
public class CardDriver extends JFrame 
{
    // instance (class level) variables
    private final String FILE_NAME = "src/resources/Statistics.txt";
    DeckOfCards deck = new DeckOfCards();
    private int numbersSkipped;
    private int gamesPlayed;
    private int correctGuesses;
    private int totalGuesses;    
    private double successRate;
    private SaveForm saveForm;

    /**
     * default constructor
     */
    public CardDriver() 
    {
        initComponents();
        // set default button to verifyJButton
        this.getRootPane().setDefaultButton(verifyJButton); 
        expressionJTextField.requestFocus();
        // center the form
        this.setTitle("24 Game Card");
        this.setLocationRelativeTo(null); 
        //setIcon();
        this.setIconImage(Toolkit.getDefaultToolkit().getImage
                ("src/resources/icon.jpg"));
        
    }
    /**
     * set the image of the card from the ArrayList using the four randomized
     * number.
     */
    private void setIcon()
    {
        deck.refresh();
        card1JLabel.setIcon(deck.list.get(deck.one));
        card2JLabel.setIcon(deck.list.get(deck.two));
        card3JLabel.setIcon(deck.list.get(deck.three));        
        card4JLabel.setIcon(deck.list.get(deck.four));  
    }
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        displayCardJPanel = new javax.swing.JPanel();
        refreshJButton = new javax.swing.JButton();
        card1JLabel = new javax.swing.JLabel();
        card2JLabel = new javax.swing.JLabel();
        card3JLabel = new javax.swing.JLabel();
        card4JLabel = new javax.swing.JLabel();
        timerJLabel = new javax.swing.JLabel();
        timeJLabel = new javax.swing.JLabel();
        gamesPlayedJLabel = new javax.swing.JLabel();
        successJLabel = new javax.swing.JLabel();
        actionJPanel = new javax.swing.JPanel();
        expressionJLabel = new javax.swing.JLabel();
        expressionJTextField = new javax.swing.JTextField();
        verifyJButton = new javax.swing.JButton();
        startJButton = new javax.swing.JButton();
        titleJPanel = new javax.swing.JPanel();
        titleJLabel = new javax.swing.JLabel();
        iconJLabel = new javax.swing.JLabel();
        game24JMenubar = new javax.swing.JMenuBar();
        fileJMenu = new javax.swing.JMenu();
        clearJMenuItem = new javax.swing.JMenuItem();
        printJMenuItem = new javax.swing.JMenuItem();
        saveJMenuItem = new javax.swing.JMenuItem();
        exitJMenuItem = new javax.swing.JMenuItem();
        helpJMenu = new javax.swing.JMenu();
        aboutJMenuItem = new javax.swing.JMenuItem();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("24 Card Game");
        setResizable(false);

        refreshJButton.setFont(new java.awt.Font("SansSerif", 0, 15)); // NOI18N
        refreshJButton.setMnemonic('R');
        refreshJButton.setText("Refresh");
        refreshJButton.setToolTipText("Refresh Deck");
        refreshJButton.setEnabled(false);
        refreshJButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                refreshJButtonActionPerformed(evt);
            }
        });

        card1JLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/b1.png"))); // NOI18N

        card2JLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/b2.png"))); // NOI18N

        card3JLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/b1.png"))); // NOI18N

        card4JLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/b2.png"))); // NOI18N

        timerJLabel.setFont(new java.awt.Font("SansSerif", 0, 15)); // NOI18N
        timerJLabel.setForeground(new java.awt.Color(255, 0, 0));

        timeJLabel.setFont(new java.awt.Font("SansSerif", 0, 15)); // NOI18N
        timeJLabel.setText("Time:");

        gamesPlayedJLabel.setFont(new java.awt.Font("SansSerif", 0, 15)); // NOI18N
        gamesPlayedJLabel.setText("Games Played: 0");

        successJLabel.setFont(new java.awt.Font("SansSerif", 0, 15)); // NOI18N
        successJLabel.setText("Success Rate: 0.0%");

        javax.swing.GroupLayout displayCardJPanelLayout = new javax.swing.GroupLayout(displayCardJPanel);
        displayCardJPanel.setLayout(displayCardJPanelLayout);
        displayCardJPanelLayout.setHorizontalGroup(
            displayCardJPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(displayCardJPanelLayout.createSequentialGroup()
                .addGroup(displayCardJPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(displayCardJPanelLayout.createSequentialGroup()
                        .addComponent(refreshJButton)
                        .addGap(18, 18, 18)
                        .addComponent(timeJLabel)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, displayCardJPanelLayout.createSequentialGroup()
                        .addComponent(card1JLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 72, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(26, 26, 26)))
                .addGroup(displayCardJPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(displayCardJPanelLayout.createSequentialGroup()
                        .addComponent(timerJLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(gamesPlayedJLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 135, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(13, 13, 13))
                    .addGroup(displayCardJPanelLayout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addComponent(card2JLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 72, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(card3JLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 72, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGroup(displayCardJPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(displayCardJPanelLayout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(successJLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(displayCardJPanelLayout.createSequentialGroup()
                        .addGap(39, 39, 39)
                        .addComponent(card4JLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 72, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
        );
        displayCardJPanelLayout.setVerticalGroup(
            displayCardJPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(displayCardJPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(displayCardJPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(timerJLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(refreshJButton)
                    .addComponent(timeJLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(displayCardJPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(gamesPlayedJLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(successJLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 18, Short.MAX_VALUE)
                .addGroup(displayCardJPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(card2JLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(card1JLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(card3JLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(card4JLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        expressionJLabel.setFont(new java.awt.Font("SansSerif", 0, 16)); // NOI18N
        expressionJLabel.setText("Enter an expression:");

        expressionJTextField.setFont(new java.awt.Font("SansSerif", 0, 16)); // NOI18N
        expressionJTextField.setToolTipText("Type an Expression");
        expressionJTextField.setEnabled(false);

        verifyJButton.setFont(new java.awt.Font("SansSerif", 0, 16)); // NOI18N
        verifyJButton.setMnemonic('V');
        verifyJButton.setText("Verify");
        verifyJButton.setToolTipText("Verify Expression");
        verifyJButton.setEnabled(false);
        verifyJButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                verifyJButtonActionPerformed(evt);
            }
        });

        startJButton.setFont(new java.awt.Font("SansSerif", 0, 16)); // NOI18N
        startJButton.setMnemonic('S');
        startJButton.setText("Start");
        startJButton.setToolTipText("Start Game");
        startJButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                startJButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout actionJPanelLayout = new javax.swing.GroupLayout(actionJPanel);
        actionJPanel.setLayout(actionJPanelLayout);
        actionJPanelLayout.setHorizontalGroup(
            actionJPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(actionJPanelLayout.createSequentialGroup()
                .addGap(9, 9, 9)
                .addComponent(expressionJLabel)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(expressionJTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 173, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(verifyJButton)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(startJButton, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        actionJPanelLayout.setVerticalGroup(
            actionJPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, actionJPanelLayout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(actionJPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(expressionJLabel)
                    .addComponent(expressionJTextField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(verifyJButton)
                    .addComponent(startJButton))
                .addGap(12, 12, 12))
        );

        titleJLabel.setFont(new java.awt.Font("Verdana", 1, 26)); // NOI18N
        titleJLabel.setText("24 CARD GAME");

        iconJLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/cards.jpg"))); // NOI18N
        iconJLabel.setPreferredSize(null);

        javax.swing.GroupLayout titleJPanelLayout = new javax.swing.GroupLayout(titleJPanel);
        titleJPanel.setLayout(titleJPanelLayout);
        titleJPanelLayout.setHorizontalGroup(
            titleJPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, titleJPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(iconJLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 120, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(28, 28, 28)
                .addComponent(titleJLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 227, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(128, 128, 128))
        );
        titleJPanelLayout.setVerticalGroup(
            titleJPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(titleJPanelLayout.createSequentialGroup()
                .addComponent(iconJLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 68, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
            .addGroup(titleJPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(titleJLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        fileJMenu.setMnemonic('F');
        fileJMenu.setText("File");
        fileJMenu.setToolTipText("");

        clearJMenuItem.setMnemonic('C');
        clearJMenuItem.setText("Clear");
        clearJMenuItem.setToolTipText("Clear Fields");
        clearJMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                clearJMenuItemActionPerformed(evt);
            }
        });
        fileJMenu.add(clearJMenuItem);

        printJMenuItem.setMnemonic('P');
        printJMenuItem.setText("Print");
        printJMenuItem.setToolTipText("Print Form");
        printJMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                printJMenuItemActionPerformed(evt);
            }
        });
        fileJMenu.add(printJMenuItem);

        saveJMenuItem.setMnemonic('S');
        saveJMenuItem.setText("Save");
        saveJMenuItem.setToolTipText("Save Statistics\n");
        saveJMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                saveJMenuItemActionPerformed(evt);
            }
        });
        fileJMenu.add(saveJMenuItem);

        exitJMenuItem.setMnemonic('E');
        exitJMenuItem.setText("Exit");
        exitJMenuItem.setToolTipText("Exit Program");
        exitJMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                exitJMenuItemActionPerformed(evt);
            }
        });
        fileJMenu.add(exitJMenuItem);

        game24JMenubar.add(fileJMenu);

        helpJMenu.setMnemonic('H');
        helpJMenu.setText("Help");
        helpJMenu.setToolTipText("");

        aboutJMenuItem.setMnemonic('A');
        aboutJMenuItem.setText("About");
        aboutJMenuItem.setToolTipText("Aboout Form");
        aboutJMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                aboutJMenuItemActionPerformed(evt);
            }
        });
        helpJMenu.add(aboutJMenuItem);

        game24JMenubar.add(helpJMenu);

        setJMenuBar(game24JMenubar);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(actionJPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(displayCardJPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(titleJPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(titleJPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(displayCardJPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(1, 1, 1)
                .addComponent(actionJPanel, javax.swing.GroupLayout.PREFERRED_SIZE, 48, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(27, 27, 27))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents
    /**
     * refresh the cards
     * @param evt action event
     */
    private void refreshJButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_refreshJButtonActionPerformed
        setIcon();
        expressionJTextField.setText("");
        expressionJTextField.requestFocus();
        numbersSkipped++;
//        numbersSkippedJLabel.setText("Games Played: " + numbersSkipped);
    }//GEN-LAST:event_refreshJButtonActionPerformed
    /**
     * verify if value of the cards are same as numbers in expression
     * and if expression comes out to be 24. Show message if they are true or
     * false.
     * @param evt action event
     */
    private void verifyJButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_verifyJButtonActionPerformed
        expressionJTextField.requestFocus();
        expressionJTextField.selectAll();
        String expression = expressionJTextField.getText();        
        try 
        {
            totalGuesses++;
            if(checkExpression() == true)
            {                
                if(evaluateExpression(expression) == 24)
                {
                    JOptionPane.showMessageDialog(null, "Great Job! You got 24!",
                            "Correct!", JOptionPane.INFORMATION_MESSAGE);
                    correctGuesses++;  
                    setIcon();
                    expressionJTextField.setText("");                    
                }
                else
                {
                    JOptionPane.showMessageDialog(null, "Try another expression",
                            "Incorrect.", JOptionPane.WARNING_MESSAGE);
                }    
            }
            else 
            {
                JOptionPane.showMessageDialog(null, "The numbers in the expression"
                        + " don't match the numbers in the set",
                        "Message", JOptionPane.WARNING_MESSAGE);
            }
            double success = (double) correctGuesses / totalGuesses * 100;
            successRate =  Math.round(success * 100.0) / 100.0;
            successJLabel.setText("Success Rate: " + successRate + "%");
        } 
        catch (FullStackException ex) 
        {
            JOptionPane.showMessageDialog(null, ex);
        } 
        catch (EmptyStackException ex) 
        {
            JOptionPane.showMessageDialog(null, ex);
        }
    }//GEN-LAST:event_verifyJButtonActionPerformed
    /**
     * clear all fields, statistics, and set cards to default
     * @param evt action event
     */
    private void clearJMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_clearJMenuItemActionPerformed
        JOptionPane.showMessageDialog(null, "All fields and text file are cleared",
                            "Cleared!", JOptionPane.INFORMATION_MESSAGE);
        ImageIcon b1 = new ImageIcon("src/resources/b1.png");
        ImageIcon b2 = new ImageIcon("src/resources/b2.png");
        expressionJTextField.setText("");
        gamesPlayedJLabel.setText("Games Played: 0");
        successJLabel.setText("Success Rate: 0.0%");
        timerJLabel.setText("");
        count = 0;
        refreshJButton.setEnabled(false);
        verifyJButton.setEnabled(false);
        startJButton.setEnabled(true);
        expressionJTextField.setEnabled(false);
        numbersSkipped = 0;
        gamesPlayed = 0;
        correctGuesses = 0;
        totalGuesses = 0;    
        successRate = 0.0;
        clearStats();
        card1JLabel.setIcon(b1);
        card2JLabel.setIcon(b2);
        card3JLabel.setIcon(b1);
        card4JLabel.setIcon(b2);   
    }//GEN-LAST:event_clearJMenuItemActionPerformed
    /**
     * exit the program
     * @param evt action event
     */
    private void exitJMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_exitJMenuItemActionPerformed
        System.exit(0);
    }//GEN-LAST:event_exitJMenuItemActionPerformed
    /**
     * print the form
     * @param evt action event
     */
    private void printJMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_printJMenuItemActionPerformed
        //using an exisiting helper file from
        //http://www.apl.jhu.edu/~hall/java/Swing-Tutorial/Swing-Tutorial/-Printing.html
        PrintUtilities.printComponent(this);
    }//GEN-LAST:event_printJMenuItemActionPerformed
    /**
     * start the timer and the game by enabling some buttons
     * @param evt action event
     */   
    private void startJButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_startJButtonActionPerformed
        timer.start();        
        setIcon();
        refreshJButton.setEnabled(true);
        verifyJButton.setEnabled(true);        
        expressionJTextField.setEnabled(true);
        expressionJTextField.requestFocus();
        startJButton.setEnabled(false);
        gamesPlayed++;
        gamesPlayedJLabel.setText("Games Played: " + Integer.toString(gamesPlayed));
    }//GEN-LAST:event_startJButtonActionPerformed
    /**
     * brings up the AboutForm JDialog
     * @param evt action event
     */
    private void aboutJMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_aboutJMenuItemActionPerformed
        AboutForm myAbout = new AboutForm (this, true);
        myAbout.setVisible(true);
    }//GEN-LAST:event_aboutJMenuItemActionPerformed
    /**
     * clear statistics in Statistics.txt and show message if file is not found
     */
    private void clearStats()
    {
        try
        {
            FileWriter fileName = new FileWriter(FILE_NAME, false); 
            PrintWriter output = new PrintWriter(fileName);            
            output.println("---Statistics Cleared---");
            output.println("Numbers Skipped: 0");
            output.println("Correct Guesses: 0");
            output.println("Total Guesses: 0");
            output.println("Games Played: 0");
            output.println("Success Rate: 0"); 
            output.close();
        }        
        catch(FileNotFoundException ex)
        {
            JOptionPane.showMessageDialog(null, "Unable to find " + FILE_NAME,
                            "File Error!", JOptionPane.INFORMATION_MESSAGE);
        }
        catch(IOException ex)
        {
            JOptionPane.showMessageDialog(null, "Error: Something went wrong.",
                            "Error!", JOptionPane.INFORMATION_MESSAGE);
        }
    }
    /**
     * saves statistics to Statistics.txt and show message if file is not found
     */
    private void saveStats()
    {
        try
        {
            FileWriter fileName = new FileWriter(FILE_NAME, false); 
            PrintWriter output = new PrintWriter(fileName);            
           
            String skipped = Integer.toString(numbersSkipped);
            output.println("Numbers Skipped: " + skipped);
            String correct = Integer.toString(correctGuesses);
            output.println("Correct Guesses: " + correct);
            String total = Integer.toString(totalGuesses);
            output.println("Total Guesses: " + total);
            String games = gamesPlayedJLabel.getText();
            output.println(games);
            String success = successJLabel.getText();
            output.println(success);                      
            output.close();
        }        
        catch(FileNotFoundException ex)
        {
            JOptionPane.showMessageDialog(null, "Unable to find " + FILE_NAME,
                            "File Error!", JOptionPane.INFORMATION_MESSAGE);
        }
        catch(IOException ex)
        {
            JOptionPane.showMessageDialog(null, "Error: Something went wrong.",
                            "Error!", JOptionPane.INFORMATION_MESSAGE);
        }
    }
    /**
     * call saveStats()
     * @param evt action event
     */
    private void saveJMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_saveJMenuItemActionPerformed
        JOptionPane.showMessageDialog(null, "Results saved in " + FILE_NAME + ".",
                            "Saved!", JOptionPane.INFORMATION_MESSAGE);
        saveStats();
    }//GEN-LAST:event_saveJMenuItemActionPerformed

    /** 
    * Evaluate an expression by taking integers and operators and put them 
    * into 2 different Stack, operandStack and operatorStack.
    * @param expression expression that user types
    * @return result of evaluation
    * @throws Stack.FullStackException
    * @throws Stack.EmptyStackException  
    */
    private int evaluateExpression(String expression) 
            throws FullStackException, EmptyStackException
    {        
        // Create operandStack to store operands
        GenericStack<Integer> operandStack = new GenericStack<>();
        // Create operatorStack to store operators
        GenericStack<Character> operatorStack = new GenericStack<>();
	   
        // Extract operands and operators
        StringTokenizer tokens = new StringTokenizer(expression, " +-/*%()", true);

        // Phase 1: Scan tokens
        while (tokens.hasMoreTokens()) 
        {
            String token = tokens.nextToken().trim(); // Extract a token
            if (token.length() != 0) //Blank space
                if (token.charAt(0) == '+' || token.charAt(0) == '-')
                {
                    //Process all +, -, *, / in the top of the operator stack
                    while (!operatorStack.isEmpty() &&
                            (operatorStack.peek() == '+' ||
                            operatorStack.peek() == '-' ||
                            operatorStack.peek() == '*' ||
                            operatorStack.peek() == '/'))
                    {
                        processAnOperator(operandStack, operatorStack);
                    }
                    
                    // Push the + or - operator into the operator stack
                    operatorStack.push(token.charAt(0));
                }
                
                else if (token.charAt(0) == '*' || token.charAt(0) == '/')
                {
                    // Process all *, / in the top of the operator stack
                    while (!operatorStack.isEmpty() &&
                            (operatorStack.peek().equals('*') ||
                            operatorStack.peek().equals('/')))
                    {
                        processAnOperator(operandStack, operatorStack);
                    }
                    
                    // Push the * or / operator into the operator stack
                    operatorStack.push(token.charAt(0));
                }
                else if (token.trim().charAt(0) == '(')
                {
                    operatorStack.push('('); // Push '(' to stack
                }
                else if (token.trim().charAt(0) == ')')
                {
                    //Process all the operators in the stack until seeing '('
                    while (operatorStack.peek() != '(')
                    {
                        processAnOperator(operandStack, operatorStack);
                    }                    
                    operatorStack.pop(); // Pop the '(' symbol from the stack
                }
                else 
                {   //An operand scanned
                    //Push an operand to the stack
                    operandStack.push(new Integer(token));
                }            //Back to the while loop to extract the next token
        }
	//Phase 2: process all the remaining operators in the stack
        while (!operatorStack.isEmpty()) 
        {
            processAnOperator(operandStack, operatorStack);
        }        
        // Return the result
        return operandStack.pop();
    }    
    /**
     * provide a method for evaluateExpression to process operator
     * @param operandStack operand stacks
     * @param operatorStack operator stacks
     * @throws FullStackException
     * @throws EmptyStackException 
     */
    private void processAnOperator(GenericStack<Integer> operandStack, 
            GenericStack<Character> operatorStack)
            throws FullStackException, EmptyStackException
    {
        char op = operatorStack.pop();
        int op1 = operandStack.pop();
        int op2 = operandStack.pop();
        if (op == '+')
            operandStack.push(op2 + op1);
        else if (op == '-')
            operandStack.push(op2 - op1);
        else if (op == '*')
            operandStack.push(op2 * op1);
        else if (op == '/')
            operandStack.push(op2 / op1);    
    }
    /**
     * @return boolean checking if the value of the cards and expression are the 
     *          same, by checking if checkList, grabbed from the expression,
     *          contains all value in the cardList, which is value from card 
     *          displayed.
     * @throws FullStackException
     * @throws EmptyStackException 
     */
    private boolean checkExpression()
            throws FullStackException, EmptyStackException
    {  
        int card1 = deck.one + 1;
        int card2 = deck.two + 1;
        int card3 = deck.three + 1;
        int card4 = deck.four + 1;
        
        int cardVal1 = 0;
        int cardVal2 = 0;
        int cardVal3 = 0;
        int cardVal4 = 0;
        
        // card1
        if((card1 > 0 && card1 <= 13))
        {
            cardVal1 = card1;
        }
        if((card1 > 13 && card1 <= 26))
        {
            cardVal1 = card1 - 13;            
        }
        if((card1 > 26 && card1 <= 39))
        {
            cardVal1 = card1 - 26;
        }
        if((card1 > 39 && card1 <= 52))
        {
            cardVal1 = card1 - 39;            
        }        
        // card2
        if((card2 > 0 && card2 <= 13))
        {
            cardVal2 = card2;
        }
        if((card2 > 13 && card2 <= 26))
        {
            cardVal2 = card2 - 13;
        }
        if((card2 > 26 && card2 <= 39))
        {
            cardVal2 = card2 - 26;
        }
        if((card2 > 39 && card2 <= 52))
        {
            cardVal2 = card2 - 39;                
        }
        // card3
        if((card3 > 0 && card3 <= 13))
        {
            cardVal3 = card3;
        }
        if((card3 > 13 && card3 <= 26))
        {
            cardVal3 = card3 - 13;
        }
        if((card3 > 26 && card3 <= 39))
        {
            cardVal3 = card3 - 26;
        }
        if((card3 > 39 && card3 <= 52))
        {
            cardVal3 = card3 - 39;                
        }
        // card4
        if((card4 > 0 && card4 <= 13))
        {
            cardVal4 = card4;
        }
        if((card4 > 13 && card4 <= 26))
        {
            cardVal4 = card4 - 13;
        }
        if((card4 > 26 && card4 <= 39))
        {
            cardVal4 = card4 - 26;
        }
        if((card4 > 39 && card4 <= 52))
        {
            cardVal4 = card4 - 39;                
        }
        
        String expression = expressionJTextField.getText();
        ArrayList<Integer> checkList = new ArrayList<>();
        Pattern p = Pattern.compile("\\d+");
        Matcher m = p.matcher(expression);
        while(m.find())
        {
            checkList.add(Integer.parseInt(m.group()));
        }
        List<Integer> cardList = new ArrayList<>();
        cardList.add(cardVal1);
        cardList.add(cardVal2);
        cardList.add(cardVal3);
        cardList.add(cardVal4);
        
        return checkList.containsAll(cardList);
    }
    
    /**
     * nested inner class--create a 60 seconds timer by creating timer class 
     * and provide methods to enable game. It sets all fields and cards 
     * to default if time runs out.
     */ 
    private int count = 120;
    Timer timer = new Timer(1000, new ActionListener() 
    {
        @Override
        public void actionPerformed(ActionEvent e) 
        {
            
            if (count <= 0) {
                timerJLabel.setText(" ");
                expressionJTextField.setEnabled(false);
                refreshJButton.setEnabled(false);
                verifyJButton.setEnabled(false);
                startJButton.setEnabled(true);
                expressionJTextField.setText("");
                ImageIcon b1 = new ImageIcon("src/resources/b1.png");
                ImageIcon b2 = new ImageIcon("src/resources/b2.png");
                expressionJTextField.setText("");                          
                card1JLabel.setIcon(b1);
                card2JLabel.setIcon(b2);
                card3JLabel.setIcon(b1);
                card4JLabel.setIcon(b2);
                JOptionPane.showMessageDialog(null, "Game is Over."
                            + " Press 'Start' to play a new game.",
                            "GAME OVER", JOptionPane.WARNING_MESSAGE);
                ((Timer)e.getSource()).stop();
                count = 60;
            } 
            else 
            {
                timerJLabel.setText(Integer.toString(count));
                count--;
            }
        }
    });        
            
    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(CardDriver.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(CardDriver.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(CardDriver.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(CardDriver.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>
        
        
        
        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() 
        {
            public void run() 
            {
                new CardDriver().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JMenuItem aboutJMenuItem;
    private javax.swing.JPanel actionJPanel;
    private javax.swing.JLabel card1JLabel;
    private javax.swing.JLabel card2JLabel;
    private javax.swing.JLabel card3JLabel;
    private javax.swing.JLabel card4JLabel;
    private javax.swing.JMenuItem clearJMenuItem;
    private javax.swing.JPanel displayCardJPanel;
    private javax.swing.JMenuItem exitJMenuItem;
    private javax.swing.JLabel expressionJLabel;
    private javax.swing.JTextField expressionJTextField;
    private javax.swing.JMenu fileJMenu;
    private javax.swing.JMenuBar game24JMenubar;
    private javax.swing.JLabel gamesPlayedJLabel;
    private javax.swing.JMenu helpJMenu;
    private javax.swing.JLabel iconJLabel;
    private javax.swing.JMenuItem printJMenuItem;
    private javax.swing.JButton refreshJButton;
    private javax.swing.JMenuItem saveJMenuItem;
    private javax.swing.JButton startJButton;
    private javax.swing.JLabel successJLabel;
    private javax.swing.JLabel timeJLabel;
    private javax.swing.JLabel timerJLabel;
    private javax.swing.JLabel titleJLabel;
    private javax.swing.JPanel titleJPanel;
    private javax.swing.JButton verifyJButton;
    // End of variables declaration//GEN-END:variables
}